<main>
  {{#if hasResults}}

  <ul>
    {{#each results}}
    <li class="search-result">

      <div><img src="https://image.tmdb.org/t/p/w185_and_h278_bestv2/{{poster_path}}" alt="{{title}}"
          class="search-poster"></div>
      <div class="search-info">
        <a href="/movie/{{id}}"><h1>{{title}}</h1></a>
        <div>
          <a class="waves-effect waves-light btn-small" class="add_circle_outline" data-id={{id}} data-title={{title}} data-poster={{poster_path}}>Add to Wish List</a>
          <a class="waves-effect waves-light btn-small" class="add_circle_outline" data-id="{{id}}" data-title="{{title}}" data-poster="{{poster_path}}">Add to Watched List</a>
        <a href="/movie/{{id}}">
          <h1>{{title}}</h1>
        </a>
        <div id="buttons-{{id}}">
          <button class="wishlist-button btn" data-id={{id}} data-title={{title}} data-poster={{poster_path}}>Add to
            Wishlist</button>
          <button class="watchedlist-button btn" data-id="{{id}}" data-title="{{title}}"
            data-poster="{{poster_path}}">Add to Watchedlist</button>
        </div>
      </div>


    </li>
    {{/each}}
  </ul>
  {{else}}
  You have no search results
  {{/if}}

</main>

<script>
  console.log("adsfasd")
  $(document).ready(function () {
    var results = [];
    {{#each results }}
      results.push({
        id: {{id}},
        title: "{{title}}",
        poster_path: "{{poster_path}}"
      })
    {{/each}}
    console.log("this", results);

    requestList("watchedList", function (data) {
      console.log("received", data);
      console.log(typeof data, data)
      data.map(movie => {
        var foundInResults = results.filter(res => res.id === movie.id);
        if( foundInResults.length > 0) {
          $("#button-"+ movie.id).text("Remove from watchedList")
        }
      })
    })
  });
</script>